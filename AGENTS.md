# Repository Guidelines

1. 尽量使用中文回复
2. 如果没有强制要求，尽量不要写兼容代码

## Project Structure & Module Organization

- `src/main/` – Electron main process (window creation, app lifecycle).
- `src/preload/` – preload scripts, bridges `electron`/`api` into the renderer.
- `src/renderer/` – React front-end (SPA UI, components, assets).
- `resources/` – application icons and packaging assets.
- `build/` – build artifacts generated by `electron-vite` / `electron-builder`.

Keep new code in the appropriate layer (main vs preload vs renderer) and avoid cross‑layer imports.

## Build, Test, and Development Commands

核心命令：

- `pnpm dev` – 启动开发模式（Electron + 渲染层 HMR）
- `pnpm build` – 类型检查 + 生产构建
- `pnpm start` – 运行构建后的应用
- `pnpm lint` – 运行 ESLint
- `pnpm typecheck` – TypeScript 类型检查

数据库命令：

- `pnpm db:generate` – 生成数据库迁移文件
- `pnpm db:migrate` – 执行数据库迁移
- `pnpm db:studio` – 打开 Drizzle Studio 查看数据库

构建与发布：

- `pnpm build:stable` – 构建稳定版
- `pnpm build:nightly` – 构建 Nightly 版
- `pnpm release:stable` – 发布稳定版到 GitHub
- `pnpm release:nightly` – 发布 Nightly 版到 GitHub

Use `pnpm` consistently; do not mix `npm`/`yarn` in scripts or docs.

## Coding Style & Naming Conventions

- Language: TypeScript for main, preload, and renderer code.
- Formatting: Prettier (`pnpm format`) with default repo config.
- Linting: ESLint with `@electron-toolkit` presets.
- Indentation: 2 spaces for TS/JS/React; no tabs.
- Naming: `PascalCase` for React components, `camelCase` for variables/functions, `SCREAMING_SNAKE_CASE` for constants.

Prefer small, focused modules; keep platform‑specific logic in main/preload instead of the renderer.

## Testing Guidelines

项目已配置 Vitest 测试框架：

- `pnpm test` – 运行所有测试
- `pnpm test:watch` – 监视模式运行测试

测试规范：

- 测试文件放置在源文件旁，命名为 `*.test.ts(x)`
- 优先编写轻量、确定性的测试（避免真实网络或文件系统副作用）
- 核心功能应有对应的单元测试覆盖

## Commit & Pull Request Guidelines

- Commits: use clear, imperative messages (e.g., `Add preload API for fs access`, `Fix renderer crash on startup`).
- Scope commits narrowly; avoid mixing refactors with behavior changes.
- Pull Requests:
  - Provide a concise description and rationale.
  - Reference related issues (e.g., `Closes #123`).
  - Include before/after screenshots for visible UI changes.
  - Mention any new commands, config, or breaking changes.

## Security & Configuration Tips

- Never commit secrets or API keys; use environment variables or secure config files.
- Be careful with filesystem and shell access from renderer; route privileged operations through preload/main only.
