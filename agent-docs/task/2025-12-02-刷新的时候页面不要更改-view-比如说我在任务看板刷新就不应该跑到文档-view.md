---
title: 刷新的时候页面不要更改 view. 比如说我在任务看板刷新就不应该跑到文档 view。
status: done
priority: P2
---

# 刷新的时候页面不要更改 view. 比如说我在任务看板刷新就不应该跑到文档 view。

## 任务描述

刷新的时候页面不要更改 view. 比如说我在任务看板刷新就不应该跑到文档 view。

## 实现方案

✅ **已实现** - 通过 Zustand 的持久化中间件实现视图状态保存

### 技术实现

1. **状态持久化**: 使用 `useProjectPreviewStore` 配合 Zustand 的 `persist` 中间件，将 `activeView` 状态保存到 localStorage
2. **智能初始化**: `ensure` 函数只在项目首次访问时创建默认状态，后续访问时保持现有状态
3. **无重置逻辑**: 代码中没有任何会在刷新时重置视图的逻辑

### 相关代码

- `src/renderer/src/features/workspace/state/store.ts` - 状态管理和持久化配置
- `src/renderer/src/features/workspace/views/WorkspaceLayout.tsx` - 视图状态使用
- `src/renderer/src/features/workspace/components/ActivityBar.tsx` - 视图切换组件

### 验证

刷新页面后，当前视图（看板/文档/Git/设置）会保持不变，不会跳转到默认的文档视图。
