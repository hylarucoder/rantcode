---
title: 任务看板增强功能
status: doing
priority: P2
owner: AI
---

# 任务看板增强功能

## 概述

✅ **主要功能已完成** - 新建任务、任务详情查看、拖拽管理等核心功能已实现

❌ **过滤搜索功能待实现** - 按优先级/负责人过滤、搜索功能等增强特性尚未开发

## 目标

在已完成的任务看板基础上，添加更多实用功能。

## 前置依赖

- ✅ `implement-task-board.md` - 基础看板功能已完成

## 完成项

### 新建任务功能 ✅

- [x] 在看板 UI 添加"新建任务"按钮
- [x] 实现任务创建弹窗/表单
  - 任务标题（通过任务描述生成）
  - 初始状态（默认 backlog，可选择）
  - 优先级选择（P0/P1/P2）
  - 负责人（可选）
- [x] 通过 AI 助手自动生成 `.md` 文件到 `agent-docs/task/` 目录
- [x] 自动填充 frontmatter 模板
- [x] 集成全局聊天，发送详细提示词给 AI 创建任务文档

### 任务详情增强 ✅

- [x] 点击任务卡片标题展开文档详情抽屉
- [x] 使用 DocDrawer 组件显示任务的完整 Markdown 内容
- [x] 支持在抽屉中查看完整文档
- [x] 文档修改时自动刷新看板状态

### 任务管理功能 ✅

- [x] 拖拽任务卡片改变状态
- [x] 右键菜单快速移动任务到其他列
- [x] 任务状态实时同步到文件 frontmatter
- [x] 支持打开任务文件（通过右键菜单）
- [x] 支持与特定文件聊天（通过右键菜单）
- [x] 任务状态检查功能（通过右键菜单）

## 未实现功能

### 过滤与搜索 ❌

- [ ] 按优先级过滤（P0/P1/P2）
- [ ] 按负责人过滤
- [ ] 任务标题搜索
- [ ] 支持多选批量操作

### 任务编辑增强 ❌

- [ ] 在任务详情抽屉中直接编辑任务内容
- [ ] 显示任务的修改历史
- [ ] 快速修改任务优先级和负责人

## 技术实现说明

### 核心组件
- **KanbanPanel**: 主要看板组件，位于 `src/renderer/src/features/workspace/components/KanbanPanel.tsx`
- **DocDrawer**: 文档预览抽屉，用于查看任务详情
- **全局聊天集成**: 通过 `useGlobalChatStore` 创建新任务

### 新建任务流程
1. 用户点击"新建任务"按钮，打开对话框
2. 填写任务描述、选择状态、优先级、负责人
3. 点击"发送到聊天"，自动构建详细提示词
4. 打开全局聊天窗口，AI 根据提示词创建任务文档
5. 文件系统监听器检测到新文件，自动刷新看板

### 文件监听机制
- 通过 `window.api.docs.subscribe` 监听 `agent-docs/task/` 目录变化
- 使用 `queueMicrotask` 防抖，避免频繁刷新
- 支持实时同步任务状态变更

### 拖拽实现
- 使用 `@dnd-kit` 库实现拖拽功能
- 支持跨列拖拽和同列排序
- 拖拽结束后自动更新文件 frontmatter

## 验收标准

- [x] 可以在 UI 中新建任务文件
- [x] 任务详情可正常查看（通过 DocDrawer）
- [ ] 过滤和搜索功能正常工作

## 后续建议

1. **实现过滤搜索功能**: 在看板顶部添加过滤器和搜索框
2. **增强任务编辑**: 在 DocDrawer 中添加编辑模式
3. **批量操作**: 支持多选任务进行批量状态变更
4. **任务依赖关系**: 可视化任务之间的依赖关系
5. **时间跟踪**: 添加任务时间估算和实际耗时记录

